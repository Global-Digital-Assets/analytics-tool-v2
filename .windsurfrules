1. Code Style & Quality (Pythonâ€‘centric)
* PEPâ€¯8 + PEPâ€¯257 complianceEnforce with Black (formatter) + Flake8 (linter) + pydocstyle for docstrings.
* Type hints everywhereRun mypyâ€¯--strict in CI; avoid Any except when truly unavoidable.
* Immutable data modelsUse @dataclass(frozen=True) or Pydantic BaseModel with Config.allow_mutation=False.
2. Dependency & Environment Management
* Poetry or pipâ€‘tools for reproducible installs:
    * Lock poetry.lock / requirements.txt.
    * Pin to exact versions; review lockfile diffs in PRs.
* Virtual environments per project (no global installs).
* Separate Dockerfiles for dev vs. prod; multiâ€‘stage builds to minimize image size.
3. Configuration & Secrets
* Pydantic BaseSettings backed by ENV + .env for typed config.
* Never import os.getenv throughout codeâ€”read all settings at bootstrap, pass via constructor.
* Vault or AWS Secrets Manager for production; fall back to envâ€‘vars in staging/dev.
4. Packaging & Releases
* Structure as a proper Python package (src/ layout).
* Use setup.cfg/pyproject.toml metadata; publish to private PyPI if reusable.
* Automate changelog & version bump via Commitizen or Semanticâ€‘Release.
5. VPS Deployment & Web Server
* Docker Compose (or Kubernetes) on VPS for service isolation.
* Nginx â†’ Gunicorn/Uvicorn reverse proxy:
    * Set worker_processes = auto, timeout = 30s.
    * Run Gunicorn as a systemd service with proper User/Group.
* Firewall (ufw or iptables): only open ports 80/443 and SSH.
* Letâ€™s Encrypt (Certbot) autoâ€‘renew for TLS; verify via cron or systemd timer.
6. Crypto & Binance Integration
* Use the official pythonâ€‘binance SDK (or CCXT if multiâ€‘exchange).
* Decimalâ€‘based arithmetic (decimal.Decimal) for price/qtyâ€”never floats.
* API rateâ€‘limit handler: wrap calls with exponential backoff + jitter.
* Idempotency for order placement: generate unique clientOrderId.
* Maintain a local ledger DB of sent orders + responses to reconcile fills.
7. Security & Key Management
* Store API keys in encrypted vault; load at runtime, never commit.
* Restrict Binance key permissions (e.g. disable withdrawals unless testnet).
* Validate server time against NTP to avoid signature errors.
* Enable HTTP headers: HSTS, Xâ€‘Frameâ€‘Options, Content Security Policy.
8. Testing & CI/CD (Python Flavour)
* pytest with plugins:
    * pytestâ€‘asyncio for async routes
    * pytestâ€‘mock / vcr.py for replaying Binance HTTP interactions
* FactoryBoy or faker for test data; avoid liveâ€‘trading in CI (use testnet mocks).
* CI pipeline:
    1. Black â†’ Flake8 â†’ MyPy
    2. Unit tests â†’ Coverage (â†’ fail if <â€¯90â€¯%)
    3. Build Docker image â†’ Push to registry â†’ Deploy to staging
9. Logging, Monitoring & Alerting
* Structured JSON logs via structlog or loguru; include request_id, user_id.
* Expose Prometheus metrics endpoint; track order rates, latencies, error counts.
* Integrate Sentry for exception capture (with PII scrubbing).
10. Performance & Scalability
* Async frameworks (FastAPI / AIOHTTP) for highâ€‘throughput I/O.
* Offload longâ€‘running tasks (e.g. heavy charting, backtests) to Celery + Redis.
* Use Redis or Memcached for caching rateâ€‘limit buckets, market data TTL.
CRYPTO ANALYTICS TOOL
Connect to your Hetzner server:ssh -i ~/.ssh/binance_futures_tool root@78.47.150.122

Hetzner server SSH key
-----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZWQyNTUxOQAAACCgKpg75l42bl6nqPGB19mhr3u/FvLqpVM+F6h83KfQngAAAKA5gORcOYDkXAAAAAtzc2gtZWQyNTUxOQAAACCgKpg75l42bl6nqPGB19mhr3u/FvLqpVM+F6h83KfQngAAAECVjT6ZU1OJy2CpOaaBDrABKwO/XHGsxASibDLcrTBy+qAqmDvmXjZuXqeo8YHX2aGve78W8uqlUz4XqHzcp9CeAAAAHWJpbmFuY2UtZnV0dXJlcy10b29sLTIwMjUwNjAx-----END OPENSSH PRIVATE KEY-----


CRYPTO ML ANALYTICS TOOL â€”Â PRODUCTION GUIDE(last updated 2025-06-07 17:20 UTC, version v2.5-cascade)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸš€ PRODUCTION SERVERâ€¢ IP / Portâ€ƒâ€ƒ78.47.150.122 : 8080â€¢ Host pathâ€ƒ /root/analytics-tool-v2â€¢ SSHâ€ƒâ€ƒâ€ƒâ€ƒ
ssh -i ~/.ssh/binance_futures_tool root@78.47.150.122
â€¢ Source-of-truthâ€ƒCode + data live on the VPS (Git = backup mirror only)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ“¡ LIVE API ENDPOINTS
| Route | Purpose | Example | |-------|---------|---------| |Â GET /api/analysisÂ | Full JSON ofÂ allÂ tracked tokens with raw scores & simple actions | returns â‰ˆ30 entries every 15 min | |Â GET /api/signalsÂ |Â ActionableÂ signals only (score â‰¥ 60 %, side = LONG / SHORT) | empty list when no trades | | GET /api/latest | Latest 1-min candle per token | | GET /api/status / /healthz | Liveness & DB connectivity | | GET /api/performance | 90-day model performance snapshot |
API process:Â simple_api_server.pyÂ (systemd unit:Â analytics-api.service).
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ’ TOKEN COVERAGE (â€œTop 30â€)BTC, ETH, BNB, ADA, SOL, XRP, DOT, LINK, AVAX, ATOM, TRX, LTC, FIL â€¦ + 17 others.Universe can be extended viaÂ 
token_list.jsonÂ in the repo; streamer auto-discovers.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ¤– ML PIPELINE & METHODOLOGYâ€¢ Modelâ€ƒâ€ƒâ€ƒâ€ƒLightGBM (binary long / short classifiers)â€¢ Featuresâ€ƒâ€ƒ11 engineered signals (RSI, momentum, volatility bands, order-book imbalance, etc.) + meta-features (regime, macro).â€¢ Training cadenceâ€“Â Nightly incrementalâ€ƒ
continuous_learner.serviceÂ (02:30 UTC).
â€“Â Monthly cold-startâ€ƒmonthly_retrain.serviceÂ +Â monthly_retrain.timerÂ (1st Sun 02:00 UTC).
â€¢ Versioningâ€ƒModels saved inÂ models/Â asÂ <timestamp>_<tag>.txt; symlinksÂ latest_model.txt,Â latest_monthly.txtÂ etc.
â€¢ Accuracyâ€ƒâ€ƒCurrent live model â‰ˆ 94 % hit-rate, 0.82 AUC (back-test).
â€¢ Drift & Perfâ€ƒml_monitoring.pyÂ runs hourly; Telegram bot alerts on drift/perf drop.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ“‚ KEY FILE / DIR MAP


CopyInsert
analytics-tool-v2/
â”œâ”€ simple_api_server.py       â† aiohttp API (port 8080)
â”œâ”€ microstructure_streamer.py â† 1-min candles â†’ SQLite
â”œâ”€ microstructure_feature_aggregator.py
â”œâ”€ production_ml_pipeline.py  â† main train/infer class
â”œâ”€ continuous_learner.py      â† nightly warm retrain
â”œâ”€ run_retrain.sh             â† monthly cold retrain wrapper
â”œâ”€ ml_monitoring.py           â† drift / perf / Telegram
â”œâ”€ market_data.db             â† live candle DB (~850 MB)
â”œâ”€ multi_token_analysis.json  â† last analysis payload (API reads)
â”œâ”€ venv/                      â† Python 3.10, pinned reqs.txt
â””â”€ systemd units in /etc/systemd/system
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ› ï¸ SYSTEMD SERVICES
| Unit | Role | Notes | |------|------|-------| |Â microstructure-streamer.serviceÂ | live Binance WS â†’ DB | auto-restart | |Â feature-aggregator.serviceÂ | aggregates & writes factors | every 1 min | |Â continuous_learner.serviceÂ | nightly warm retrain | 02:30 UTC | |Â monthly_retrain.serviceÂ | cold 365-day retrain | viaÂ 
monthly_retrain.timerÂ | |Â analytics-api.serviceÂ | serves endpoints | port 8080 | |Â monitoring_alerts.serviceÂ | drift & health alerts (Telegram) | every 15 min |

Logs default toÂ 
/var/log/syslogÂ orÂ journalctl â€‘u <unit>; custom files (streamer.log,Â analyzer.log) in project root.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ”§ COMMON OPS COMMANDS (SSH)


CopyInsert
# Check health
curl -s http://78.47.150.122:8080/api/status | jq .

# Service status / restart
systemctl status analytics-api microstructure-streamer
systemctl restart analytics-api

# Tail live analysis log
tail -f /root/analytics-tool-v2/analyzer.log

# Force immediate full retrain
sudo systemctl start monthly_retrain.service
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ›¡ï¸ SELF-HEALING & BACKUPSâ€¢ Process watchdog (
process_watchdog.sh) restarts crashed services.
â€¢ Daily DB dumpÂ backup_system.shÂ â†’Â /root/backups/Â (7-day rotation).
â€¢ Logs rotated weekly (logrotate.d/analytics).
â€¢ Security: SSH-key only, API bound to public port but no auth (internal use).

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ“¦ DEPENDENCIES (PINNED)

CopyInsert
lightgbm==4.6.0   polars==1.8.2
aiohttp==3.10.11  python-binance==1.0.29
pandas==1.5.3     numpy==1.24.3
scikit-learn==1.3.2
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ”„ DEV WORKFLOW
1. VPS is canonical.
2. Push snapshots to Git:Â git bundle create backup.bundle --all.
3. Pull bundle locally â†’ push to GitHub mirror:https://github.com/Global-Digital-Assets/analytics-tool-v2Â (branchÂ main).
4. Never overwrite live code without tar/DB backup.
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ğŸ“Š CURRENT SYSTEM STATUS (as of 2025-06-07)âœ“ Data ingestion: up (1-min candles)âœ“ ML analysis: every 15 min (48 s run time)âœ“ API: responsive (21 KB JSON)âœ“ Backups: last OK @ 02:05 UTCâœ“ Uptime: 99.9 % (self-healing)Active trade signals:Â noneÂ (all scores < 60 %).
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ For any onboarding developer:
1. SSH into the server (key in Vault).
2. Activate venv â†’Â python simple_api_server.pyÂ for local tests.
3. UseÂ /api/analysisÂ for full token universe;Â /api/signalsÂ for thresholded trades.
4. Monthly retrain & nightly learner are autonomous via systemd timers.




